title: "VM Inventory"
type: object
description: "Inventory for deploying k8s clusters via kubespray on PVE."
additionalProperties: false
required:
  - stack_name
  - qemus
  - target_pve
  - root_ssh_pub_key
properties:
  stack_name:
    type: string
    description: "Your stack name, needs to be unique within the parent_domain. Will create its own sub zone."
  target_pve:
    type: string
    description: "The pve cluster this stack should reside in, defined in ~/.pve-cloud-dyn-inv.yaml via `pvcli connect-cluster`"
  qemus:
    type: array
    description: "Nodes for the cluster in form of qemu vms."
    items:
      type: object
      properties:
        parameters:
          type: object
          description: "In accordance with pve qm cli tool, creation args."
        disk:
          type: object
          additionalProperties: false
          required:
            - size
            - pool
          properties:
            size:
              type: string
              description: "Size of the vms disk."
              example: 25G
            options:
              type: object
              description: "Mount options"
            pool:
              type: string
              description: "Ceph pool name the vms disk will be created in."
  include_stacks:
    type: array
    items:
      type: object
      description: "Include other stacks into the ansible inventory, from any PVE cluster you like."
      properties:
        stack_fqdn:
          type: string
          description: "Target stack fqdn to include (stack name + pve_cloud_domain)" # todo: same replace as lxc inv
        host_group:
          type: string
          description: "This is the name of the hosts group of our ansible inventory the included vms will be under."
        qemu_ansible_user:
          type: string
          description: User ansible will use to connect, defaults to admin.
  static_includes:
    type: object
  root_ssh_pub_key:
    type: string
    description: "Ssh key for qemu_default_user"
  pve_ha_group:
    type: string
    description: "PVE HA Group this qemu instance should be assigned to."
  qemu_default_user:
    type: string
    description: "User for cinit."
  qemu_hashed_pw:
    type: string
    description: "The hashed password that will be passed to cloudinit. Use `mkpasswd --method=SHA-512` with the fitting method for your cinit image."
  qemu_base_parameters:
    type: object
    description: "Parameters from qm create proxmox cli tool that will be passed to all created qemus."
  qemu_image_url:
    type: string
    description: "http(s) download link to the cinit image you want to use."
  qemu_keyboard_layout:
    type: string
    description: "The keyboard layout, can be and of de, en ...."
  qemu_global_vars:
    type: object
    description: "Variables that will be applied to all lxc hosts"
  pve_cloud_pytest:
    type: object
    description: Variables object used only in e2e tests.
  plugin:
    type: string
    description: Id of ansible inventory plugin
    enum:
      - pve.cloud.qemu_inv